---
---
<div id="password-gate" class="fixed inset-0 z-50 flex flex-col items-center justify-center bg-black text-green-500 font-jetbrains p-4">
  <div class="text-center">
    <div class="mb-4">ENTER ACCESS CODE</div>
    <input id="gate-input" type="password" autocomplete="off" class="bg-black text-green-500 text-center focus:outline-none border-b border-green-500 px-2 py-1 w-48" />
    <div id="gate-error" class="mt-4 text-red-500 hidden">ACCESS DENIED</div>
  </div>
</div>
<script>
  const gate = document.getElementById('password-gate');
  const input = document.getElementById('gate-input');
  const error = document.getElementById('gate-error');
  const toHex = buffer => Array.from(new Uint8Array(buffer)).map(b => b.toString(16).padStart(2, '0')).join('');
  const hash = '6c25c8f454fea8dd5cd0b201b4f739993aebfc454de7b410ee9457c553699a85';
  const closeGate = () => {
    gate.classList.add('opacity-0');
    setTimeout(() => gate.remove(), 500);
  };
  const authenticate = async () => {
    const digest = await crypto.subtle.digest('SHA-256', new TextEncoder().encode(input.value));
    if (toHex(digest) === hash) {
      sessionStorage.setItem('arkhamAuth', 'true');
      document.dispatchEvent(new Event('arkham-auth'));
      closeGate();
    } else {
      error.classList.remove('hidden');
      gate.classList.add('animate-shake');
      setTimeout(() => gate.classList.remove('animate-shake'), 300);
    }
  };
  gate.addEventListener('keydown', e => {
    if (e.key === 'Enter') {
      authenticate();
    }
  });
  if (sessionStorage.getItem('arkhamAuth') === 'true') {
    document.dispatchEvent(new Event('arkham-auth'));
    closeGate();
  }
</script>
